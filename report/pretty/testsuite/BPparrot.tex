% Remember to use the lgrind style

\Head{}
\File{code/testsuite/BPparrot.java}{2001}{5}{15}{8:18}{1685}
\L{\LB{\C{}//_Parrot:_try_to_learn_to_repeat_previous_input_by_backpropagation\CE{}}}
\L{\LB{}}
\L{\LB{\K{package}_\V{testsuite};}}
\L{\LB{}}
\L{\LB{\K{import}_\V{neurotic}.*;}}
\L{\LB{\K{import}_\V{java}.\V{io}.*;}}
\L{\LB{}}
\L{\LB{\K{public}_\K{class}_\V{BPparrot}_\{}}
\L{\LB{}}
\L{\LB{}\Tab{2}{\K{static}_\V{java}.\V{util}.\V{Random}_\V{rnd}_=_\K{new}_\V{java}.\V{util}.\V{Random}();}}
\L{\LB{}}
\index{main}\Proc{main}\L{\LB{}\Tab{2}{\K{public}_\K{static}_\K{void}_\V{main}(\V{String}[\,]_\V{argv})_\{}}
\L{\LB{}\Tab{4}{\V{Net}_\V{net}_=_\K{new}_\V{Net}(\N{1},\N{2},\N{1},\K{true});}}
\L{\LB{}}
\L{\LB{}\Tab{4}{\C{}/*_Initial_weights_hand-calculated._Good_performance_is}}
\L{\LB{}\Tab{7}{given_by_the_set}\Tab{34}{\{8,0,0,-4,0,8,0,-4,0,8,-4\}}}
\L{\LB{}\Tab{7}{so_I_start_it_fairly_close_to_this_and_let_backprop}}
\L{\LB{}\Tab{7}{do_the_rest._*/\CE{}}}
\L{\LB{}}
\L{\LB{}\Tab{4}{\V{net}.\V{setAllWeights}(\K{new}_\K{float}[\,]_\{\N{5},\-\N{1},\N{1},\-\N{5},\N{1},\N{6},\-\N{1},\-\N{3},\N{0},\N{6},\-\N{2}\});}}
\L{\LB{}\Tab{4}{\K{boolean}_\V{curr},_\V{prev}_=_\K{false};}}
\L{\LB{}\Tab{4}{\K{float}[\,]_\V{target}_=_\K{new}_\K{float}[\N{1}];}}
\L{\LB{}}
\L{\LB{}\Tab{4}{\V{net}.\V{rate}_=_\N{0.5f};}}
\L{\LB{}\Tab{4}{\V{net}.\V{momentum}_=_\N{0.5f};}}
\L{\LB{}}
\L{\LB{}\Tab{4}{\V{System}.\V{out}.\V{println}(\S{}\3Performance_before_training:\2n\3\SE{});}}
\L{\LB{}\Tab{4}{\V{test}(\V{net});}}
\L{\LB{}}
\L{\LB{}\Tab{4}{\K{int}_\V{k};}}
\L{\LB{}\Tab{4}{\K{for}_(\V{k}=\N{0};_\V{k}\<\N{800};_\V{k}++)_\{}}
\L{\LB{}\Tab{6}{\V{net}.\V{resetDeltas}();}}
\L{\LB{}\Tab{6}{\V{curr}_=_\V{rnd}.\V{nextBoolean}();}}
\L{\LB{}\Tab{6}{\V{net}.\V{setIn}(\N{0},_\V{curr}_?_\N{1}_\V{:}_\N{0});}}
\L{\LB{}\Tab{6}{\V{target}[\N{0}]_=_\V{prev}_?_\N{1}_\V{:}_\N{0};}}
\L{\LB{}\Tab{6}{\V{net}.\V{train}(\V{target});}}
\L{\LB{}\Tab{6}{\V{prev}_=_\V{curr};}}
\L{\LB{}\Tab{6}{\V{net}.\V{dumpWeights}(\V{System}.\V{err});}}
\L{\LB{}\Tab{6}{\V{net}.\V{changeWeights}();}}
\L{\LB{}\Tab{4}{\}}}
\L{\LB{}}
\L{\LB{}\Tab{4}{\V{System}.\V{out}.\V{println}(\S{}\3\2nAfter_\3\SE{}_+_\V{k}_+_\S{}\3_backprop_passes\2n\3\SE{});}}
\L{\LB{}\Tab{4}{\V{test}(\V{net});}}
\L{\LB{}}
\L{\LB{}\Tab{2}{\}}}
\L{\LB{}}
\index{test}\Proc{test}\L{\LB{}\Tab{2}{\K{static}_\K{void}_\V{test}(\V{Net}_\V{net})_\{}}
\L{\LB{}\Tab{4}{\V{StringBuffer}_\V{ins},_\V{outs};}}
\L{\LB{}\Tab{4}{\K{boolean}_\V{curr},_\V{prev}_=_\K{false};}}
\L{\LB{}\Tab{4}{\V{ins}_=_\K{new}_\V{StringBuffer}(\S{}\3Input}\Tab{35}{\3\SE{});}}
\L{\LB{}\Tab{4}{\V{outs}_=_\K{new}_\V{StringBuffer}(\S{}\3Output_\3\SE{});}}
\L{\LB{}\Tab{4}{\K{for}_(\K{int}_\V{i}=\N{0};_\V{i}\<\N{60};_\V{i}++)_\{}}
\L{\LB{}\Tab{6}{\V{curr}_=_\V{rnd}.\V{nextBoolean}();}}
\L{\LB{}\Tab{6}{\V{net}.\V{setIn}(\N{0},_\V{curr}_?_\N{1}_\V{:}_\N{0});}}
\L{\LB{}\Tab{6}{\V{net}.\V{think}();}}
\L{\LB{}\Tab{6}{\V{ins}.\V{append}(\V{curr}_?_\S{}\3*\3\SE{}_\V{:}_\S{}\3.\3\SE{});}}
\L{\LB{}\Tab{6}{\K{if}_(\V{net}.\V{getOut}(\N{0})_\<_\N{0.2})_\V{outs}.\V{append}(\S{}\3.\3\SE{});}}
\L{\LB{}\Tab{6}{\K{else}_\K{if}_(\V{net}.\V{getOut}(\N{0})_\<_\N{0.8})_\V{outs}.\V{append}(\S{}\3?\3\SE{});}}
\L{\LB{}\Tab{6}{\K{else}_\V{outs}.\V{append}(\S{}\3*\3\SE{});}}
\L{\LB{}\Tab{6}{\V{prev}_=_\V{curr};}}
\L{\LB{}\Tab{4}{\}}}
\L{\LB{}\Tab{4}{\V{System}.\V{out}.\V{println}(\V{ins});}}
\L{\LB{}\Tab{4}{\V{System}.\V{out}.\V{println}(\V{outs});}}
\L{\LB{}\Tab{4}{\C{}//_net.dumpWeights(System.err);\CE{}}}
\L{\LB{}\Tab{2}{\}}}
\L{\LB{}}
\L{\LB{\}}}
