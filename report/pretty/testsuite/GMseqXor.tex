% Remember to use the lgrind style

\Head{}
\File{code/testsuite/GMseqXor.java}{2001}{3}{26}{9:41}{1826}
\L{\LB{\C{}//_GMSeqXor:_learn_sequential_XOR_by_genetic_algorithm\CE{}}}
\L{\LB{}}
\L{\LB{\K{package}_\V{testsuite};}}
\L{\LB{}}
\L{\LB{\K{import}_\V{neurotic}.*;}}
\L{\LB{\K{import}_\V{java}.\V{io}.*;}}
\L{\LB{}}
\L{\LB{\K{public}_\K{class}_\V{GMseqXor}_\{}}
\L{\LB{}}
\L{\LB{}\Tab{2}{\K{static}_\V{java}.\V{util}.\V{Random}_\V{rnd}_=_\K{new}_\V{java}.\V{util}.\V{Random}();}}
\L{\LB{}}
\index{main}\Proc{main}\L{\LB{}\Tab{2}{\K{public}_\K{static}_\K{void}_\V{main}(\V{String}[\,]_\V{argv})_\{}}
\L{\LB{}\Tab{4}{\V{Net}_\V{net}_=_\K{new}_\V{Net}(\N{1},\N{2},\N{1},\K{true});}}
\L{\LB{}\Tab{4}{\K{boolean}_\V{curr},_\V{prev}_=_\K{false};}}
\L{\LB{}}
\L{\LB{}\Tab{4}{\V{Population}_\V{pop}_=}}
\L{\LB{}\Tab{6}{\K{new}_\V{Population}(\V{net},_\K{new}_\V{SeqXorFitness}(),_\N{128},_\N{0},_\N{4},_\N{4},_\N{4});}}
\L{\LB{}}
\L{\LB{}\Tab{4}{\V{pop}.\V{evolve}(\N{256});}}
\L{\LB{}\Tab{4}{\V{net}.\V{setAllWeights}(\V{pop}.\V{fittest}());}}
\L{\LB{}}
\L{\LB{}\Tab{4}{\V{prev}_=_\K{false};}}
\L{\LB{}\Tab{4}{\K{for}_(\K{int}_\V{i}=\N{0};_\V{i}\<\N{16};_\V{i}++)_\{}}
\L{\LB{}\Tab{8}{\V{curr}_=_\V{rnd}.\V{nextBoolean}();}}
\L{\LB{}\Tab{8}{\V{net}.\V{setIn}(\N{0},_\V{curr}_?_\N{1}_\V{:}_\N{0});}}
\L{\LB{}\Tab{8}{\V{net}.\V{think}();}}
\L{\LB{}\Tab{8}{\V{System}.\V{out}.\V{println}(_(\V{prev}_?_\S{}\3X_\3\SE{}_\V{:}_\S{}\3._\3\SE{})_+}}
\L{\LB{}\Tab{28}{(\V{curr}_?_\S{}\3X}\Tab{40}{\3\SE{}_\V{:}_\S{}\3.}\Tab{48}{\3\SE{})_+}}
\L{\LB{}\Tab{28}{((\V{prev}\5\V{curr})_?_\S{}\3X\3\SE{}_\V{:}_\S{}\3.\3\SE{})_+_}}
\L{\LB{}\Tab{28}{((\V{net}.\V{getOut}(\N{0})\>\N{0.5})_?_\S{}\3X\3\SE{}_\V{:}_\S{}\3.\3\SE{})_+}}
\L{\LB{}\Tab{28}{\S{}\3}\Tab{31}{\3\SE{}_+_(\V{net}.\V{getOut}(\N{0})_));}}
\L{\LB{}\Tab{8}{\V{prev}_=_\V{curr};}}
\L{\LB{}\Tab{4}{\}}}
\L{\LB{}\Tab{4}{\V{net}.\V{dumpWeights}(\V{System}.\V{err});}}
\L{\LB{}}
\L{\LB{}\Tab{2}{\}}}
\L{\LB{}}
\L{\LB{\}}}
\L{\LB{}}
\L{\LB{\K{class}_\V{SeqXorFitness}_\K{implements}_\V{Fitness}_\{}}
\L{\LB{}}
\L{\LB{}\Tab{2}{\K{static}_\V{java}.\V{util}.\V{Random}_\V{rnd}_=_\K{new}_\V{java}.\V{util}.\V{Random}();}}
\L{\LB{}\Tab{2}{\K{float}[\,][\,]_\V{inputs};}}
\L{\LB{}\Tab{2}{\K{float}[\,][\,]_\V{outputs};}}
\L{\LB{}\Tab{2}{\K{static}_\K{final}_\K{int}_\V{seqLen}_=_\N{8};}}
\L{\LB{}}
\index{floatXor}\Proc{floatXor}\L{\LB{}\Tab{2}{\K{private}_\K{float}_\V{floatXor}(\K{float}_\V{fa},_\K{float}_\V{fb})_\{}}
\L{\LB{}\Tab{4}{\K{boolean}_\V{ba}_=_(\V{fa}\>\N{0.5})_?_\K{true}_\V{:}_\K{false};}}
\L{\LB{}\Tab{4}{\K{boolean}_\V{bb}_=_(\V{fb}\>\N{0.5})_?_\K{true}_\V{:}_\K{false};}}
\L{\LB{}\Tab{4}{\K{return}_(\V{ba}_\5_\V{bb})_?_\N{1}_\V{:}_\N{0};}}
\L{\LB{}\Tab{2}{\}}}
\L{\LB{}}
\index{initEnviros}\Proc{initEnviros}\L{\LB{}\Tab{2}{\K{public}_\K{void}_\V{initEnviros}(\K{int}_\V{n})_\{}}
\L{\LB{}\Tab{4}{\V{inputs}_=_\K{new}_\K{float}[\V{n}][\,];}}
\L{\LB{}\Tab{4}{\V{outputs}_=_\K{new}_\K{float}[\V{n}][\,];}}
\L{\LB{}\Tab{4}{\K{for}_(\K{int}_\V{i}=\N{0};_\V{i}\<\V{n};_\V{i}++)_\{}}
\L{\LB{}\Tab{6}{\V{inputs}[\V{i}]_=_\K{new}_\K{float}[\V{seqLen}];}}
\L{\LB{}\Tab{6}{\V{outputs}[\V{i}]_=_\K{new}_\K{float}[\V{seqLen}];}}
\L{\LB{}\Tab{6}{\V{outputs}[\V{i}][\N{0}]_=_\N{0.5f};}}
\L{\LB{}\Tab{6}{\K{for}_(\K{int}_\V{j}=\N{0};_\V{j}\<\V{seqLen};_\V{j}++)_\{}}
\L{\LB{}\Tab{8}{\V{inputs}[\V{i}][\V{j}]_=_\V{rnd}.\V{nextBoolean}()_?_\N{1}_\V{:}_\N{0};}}
\L{\LB{}\Tab{8}{\K{if}_(\V{j}\>\N{0})_\V{outputs}[\V{i}][\V{j}]_=}}
\L{\LB{}\Tab{19}{\V{floatXor}(\V{inputs}[\V{i}][\V{j}],\V{inputs}[\V{i}][\V{j}\-\N{1}]);}}
\L{\LB{}\Tab{6}{\}}}
\L{\LB{}\Tab{4}{\}}}
\L{\LB{}\Tab{2}{\}}}
\L{\LB{}}
\index{score}\Proc{score}\L{\LB{}\Tab{2}{\K{public}_\K{float}_\V{score}(\V{Net}_\V{net},_\K{int}_\V{env})_\{}}
\L{\LB{}\Tab{4}{\K{float}_\V{total}_=_\N{0};}}
\L{\LB{}\Tab{4}{\V{net}.\V{flushContext}(\N{0.5f});}}
\L{\LB{}\Tab{4}{\K{for}_(\K{int}_\V{i}=\N{0};_\V{i}\<\V{seqLen};_\V{i}++)_\{}}
\L{\LB{}\Tab{6}{\V{net}.\V{setIn}(\N{0},\V{inputs}[\V{env}][\V{i}]);}}
\L{\LB{}\Tab{6}{\V{net}.\V{think}();}}
\L{\LB{}\Tab{6}{\V{total}_+=_\N{1}\-\V{Math}.\V{abs}(\V{net}.\V{getOut}(\N{0})_\-_\V{outputs}[\V{env}][\V{i}]);}}
\L{\LB{}\Tab{4}{\}}}
\L{\LB{}\Tab{4}{\K{return}_\V{total};}}
\L{\LB{}\Tab{2}{\}}}
\L{\LB{}}
\L{\LB{\}}}
