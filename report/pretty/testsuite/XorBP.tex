% Remember to use the lgrind style

\Head{}
\File{code/testsuite/XorBP.java}{2001}{4}{22}{15:50}{1073}
\L{\LB{\C{}//_XorBP:_learn_the_XOR_function_by_backpropagation\CE{}}}
\L{\LB{}}
\L{\LB{\K{package}_\V{testsuite};}}
\L{\LB{}}
\L{\LB{\K{import}_\V{neurotic}.*;}}
\L{\LB{\K{import}_\V{java}.\V{io}.*;}}
\L{\LB{}}
\L{\LB{\K{public}_\K{class}_\V{XorBP}_\{}}
\L{\LB{}}
\L{\LB{}\Tab{2}{\K{static}_\V{java}.\V{util}.\V{Random}_\V{rnd}_=_\K{new}_\V{java}.\V{util}.\V{Random}();}}
\L{\LB{}}
\index{main}\Proc{main}\L{\LB{}\Tab{2}{\K{public}_\K{static}_\K{void}_\V{main}(\V{String}[\,]_\V{argv})_\{}}
\L{\LB{}\Tab{4}{\V{Net}_\V{net}_=_\K{new}_\V{Net}(\N{2},\N{2},\N{1},\K{false});}}
\L{\LB{}\Tab{4}{\K{final}_\K{float}[\,][\,]_\V{trainingSet}_=}}
\L{\LB{}\Tab{6}{\{\{\N{0},\N{0},_\N{0}\},}}
\L{\LB{}\Tab{7}{\{\N{0},\N{1},_\N{1}\},}}
\L{\LB{}\Tab{7}{\{\N{1},\N{0},_\N{1}\},}}
\L{\LB{}\Tab{7}{\{\N{1},\N{1},_\N{0}\}\};}}
\L{\LB{}}
\L{\LB{}\Tab{4}{\V{net}.\V{rate}_=_\N{1.0f};}}
\L{\LB{}\Tab{4}{\V{net}.\V{momentum}_=_\N{0.8f};}}
\L{\LB{}\Tab{4}{\K{float}[\,]_\V{target}_=_\K{new}_\K{float}[\N{1}];}}
\L{\LB{}}
\L{\LB{}\Tab{4}{\K{int}_\V{k}_=_\N{0};}}
\L{\LB{}\Tab{4}{\K{do}_\{}}
\L{\LB{}\Tab{6}{\K{for}_(\K{int}_\V{i}=\N{0};_\V{i}\<\V{trainingSet}.\V{length};_\V{i}++)_\{}}
\L{\LB{}\Tab{8}{\V{net}.\V{resetDeltas}();}}
\L{\LB{}\Tab{8}{\V{net}.\V{setIn}(\N{0},\V{trainingSet}[\V{i}][\N{0}]);}}
\L{\LB{}\Tab{8}{\V{net}.\V{setIn}(\N{1},\V{trainingSet}[\V{i}][\N{1}]);}}
\L{\LB{}\Tab{8}{\V{target}[\N{0}]_=_\V{trainingSet}[\V{i}][\N{2}];}}
\L{\LB{}\Tab{8}{\V{net}.\V{train}(\V{target});}}
\L{\LB{}\Tab{8}{\V{net}.\V{changeWeights}();}}
\L{\LB{}\Tab{6}{\}}}
\L{\LB{}\Tab{6}{\V{k}++;}}
\L{\LB{}\Tab{4}{\}_\K{while}_(\V{net}.\V{sumSqError}()_\>_\N{0.001f});}}
\L{\LB{}}
\L{\LB{}}
\L{\LB{}\Tab{4}{\V{System}.\V{out}.\V{println}(\V{k}_+_\S{}\3_passes_through_training_set.\3\SE{});}}
\L{\LB{}\Tab{4}{\K{for}_(\K{int}_\V{i}=\N{0};_\V{i}\<\V{trainingSet}.\V{length};_\V{i}++)_\{}}
\L{\LB{}\Tab{6}{\V{net}.\V{setIn}(\N{0},\V{trainingSet}[\V{i}][\N{0}]);}}
\L{\LB{}\Tab{6}{\V{net}.\V{setIn}(\N{1},\V{trainingSet}[\V{i}][\N{1}]);}}
\L{\LB{}\Tab{6}{\V{net}.\V{think}();}}
\L{\LB{}\Tab{6}{\V{System}.\V{out}.\V{println}(\V{trainingSet}[\V{i}][\N{0}]_+_\S{}\3_XOR_\3\SE{}_+}}
\L{\LB{}\Tab{25}{\V{trainingSet}[\V{i}][\N{1}]_+_\S{}\3_=_\3\SE{}_+}}
\L{\LB{}\Tab{25}{\V{net}.\V{getOut}(\N{0}));}}
\L{\LB{}\Tab{4}{\}}}
\L{\LB{}}
\L{\LB{}\Tab{2}{\}}}
\L{\LB{\}}}
